javascript: (function() {
    // --- Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø£ÙˆÙ„: Ø§Ø³ØªØ®Ø±Ø§Ø¬ ID ÙˆØ§Ø¹ØªØ±Ø§Ø¶ WebSocket ---
    const nick = prompt("ğŸ§  Ø£Ù„ØµÙ‚ Ù‡Ù†Ø§ Ø§Ù„Ù†Ùƒ Ù†ÙŠÙ… Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù€ ID Ù„Ù‡:");
    if (!nick || nick.length < 2) {
        alert("âŒ Ø§Ù„Ù†Ùƒ Ù†ÙŠÙ… ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ ÙØ§Ø±Øº.");
        return;
    }

    const users = document.querySelectorAll('.uzr');
    let found = false;
    let extractedId = "";

    users.forEach(div => {
        const n = div.getAttribute('n');
        if (n && n.includes(nick)) {
            const uidClass = [...div.classList].find(c => c.startsWith('uid'));
            if (uidClass) {
                extractedId = uidClass.slice(3);
                found = true;
            }
        }
    });

    if (!found) {
        alert("âš  Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙŠ Ø¹Ø¶ÙˆÙŠØ© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù†Ùƒ Ù†ÙŠÙ….");
        return;
    }

    const myId = extractedId;
    const originalSend = WebSocket.prototype.send;
    WebSocket.prototype.send = function(...args) {
        const raw = args[0];
        if (typeof raw === "string" && raw.startsWith("42") && raw.includes('"msg"') && raw.includes(myId)) {
            try {
                const parsed = JSON.parse(raw.slice(2));
                const [type, payload] = parsed;
                if (type === "msg" && typeof payload === "object") {
                    const data = payload.data || {};
                    if (JSON.stringify(data).includes(myId)) {
                        window._realSocket_ = this;
                        console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ ÙÙŠ window._realSocket_");
                    }
                }
            } catch (err) {
                console.warn("âš  ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:", raw);
            }
        }
        return originalSend.apply(this, args);
    };

    alert(`âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù€ ID:\n${myId}\n\nğŸ“¡ Ø¨Ø¯Ø£ Ø§Ø¹ØªØ±Ø§Ø¶ WebSocket...`);

    // --- Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØµØ¨Ø­ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¬Ø§Ù‡Ø² ---
    const waitForSocket = setInterval(() => {
        if (window._realSocket_ && window._realSocket_.readyState === 1) {
            clearInterval(waitForSocket);

            // --- Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø«Ø§Ù†ÙŠ: ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± ---
            (function() {
                function showToast(t, e = 3000) {
                    if (!document.getElementById("mobile-toast-container")) {
                        const c = document.createElement("div");
                        c.id = "mobile-toast-container";
                        c.style = "position:fixed;top:15px;left:50%;transform:translateX(-50%);z-index:99999;max-width:320px;text-align:center";
                        document.body.appendChild(c);
                    }
                    const o = document.createElement("div");
                    o.textContent = t;
                    o.style = "background:#333;color:#fff;padding:8px 12px;margin-top:8px;border-radius:8px;cursor:pointer;font-size:13px;display:inline-block;box-shadow:0 2px 6px rgba(0,0,0,.3)";
                    o.onclick = () => o.remove();
                    document.getElementById("mobile-toast-container").appendChild(o);
                    e > 0 && setTimeout(() => o.remove(), e);
                }

                function sendSocketPayload(cmd, data) {
                    if (typeof window._realSocket_ === "undefined" || window._realSocket_.readyState !== 1) {
                        console.warn("âš  Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ WebSocket Ø¬Ø§Ù‡Ø²");
                        return false;
                    }
                    try {
                        window._realSocket_.send("42" + JSON.stringify(["msg", {
                            cmd,
                            data
                        }]));
                        return true;
                    } catch (e) {
                        console.error("âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:", e);
                        return false;
                    }
                }

                const userRoomMap = {};
                const roomNames = {};

                if (window._realSocket_) {
                    window._realSocket_.addEventListener("message", function(event) {
                        try {
                            const data = event.data;
                            if (typeof data === "string" && data.startsWith("42")) {
                                const payload = JSON.parse(data.slice(2));
                                const [eventName, content] = payload;
                                if (eventName === "msg" && content?.cmd === "wr" && Array.isArray(content.data)) {
                                    const [userId, roomId] = content.data;
                                    userRoomMap[userId] = roomId;
                                    const roomEl = document.querySelector(`.room.r${roomId}`);
                                    const roomName = roomEl?.querySelector(".u-topic")?.textContent.trim();
                                    if (roomName) roomNames[roomId] = roomName;
                                }
                            }
                        } catch (e) {}
                    });
                }

                function bindProfileElement(el) {
                    const status = el.querySelector('img[src*="s4.png"]'),
                        uid = [...el.classList].find(c => c.startsWith("uid"));
                    if (status && uid) {
                        el.style.cursor = "pointer";
                        el.onclick = () => {
                            const id = uid.replace("uid", "");
                            const topic = el.querySelector(".u-topic")?.textContent.trim() || "";
                            const picDiv = el.querySelector(".u-pic");
                            const rawBg = picDiv?.style.backgroundImage || "";
                            const bgImg = rawBg.replace(/^url\(["']?|["']?\)$/g, "").trim()
                                .replace(/\.png\.png$/, ".png")
                                .replace(/\.jpg\.png$/, ".jpg")
                                .replace(/\.jpeg\.png$/, ".jpeg");
                            window.cpShowProfile?.show ? window.cpShowProfile.show(id, topic, bgImg) : alert("Ù†Ø§ÙØ°Ø© Ø´Ùˆ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„Ø© Ø¨Ø¹Ø¯");
                        };
                    }
                }

                if (!document.getElementById("cp-showprofile-modal")) {
                    const style = document.createElement("style");
                    style.textContent = `
  #cp-showprofile-modal {position:fixed;z-index:100000;top:50%;left:50%;transform:translate(-50%,-50%);background:#0b4c4d;color:#fff;border-radius:6px;box-shadow:0 0 25px rgba(0,0,0,.5);width:340px;max-width:95%;font-family:Arial;max-height:90vh;overflow-y:auto;display:none;}
  #cp-sp-header {background:#008c8d;color:white;padding:6px 10px;display:flex;align-items:center;justify-content:space-between;font-weight:bold;font-size:15px;}
  .modal-title {display:flex;align-items:center;gap:6px;max-width:90%;overflow:hidden;}
  #cp-user-ico {height:18px;object-fit:contain;flex-shrink:0;}
  #cp-user-banner {height:30px;object-fit:contain;flex-shrink:0;}
  #cp-user-name {font-weight:bold;font-size:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
  .cp-sp-close {cursor:pointer;background:none;border:none;color:#fff;font-size:18px;}
  #cp-user-pic {width:100%;height:200px;background-size:contain;background-repeat:no-repeat;background-position:50% 50%;border-bottom:1px solid rgba(255,255,255,.1);}
  #cp-user-pic-inner {width:100%;height:100%;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);background-size:contain;background-repeat:no-repeat;background-position:50% 50%;}
  #cp-user-msg {text-align:center;padding:6px 8px;color:#ddd;border-bottom:1px solid rgba(255,255,255,.1);font-size:13px;}
  #cp-action-box {padding:10px;display:grid;grid-template-columns:repeat(3,1fr);gap:8px;}
  .cp-sp-btn {background:#17171b;border:1px solid rgba(255,255,255,.05);color:#fff;padding:10px;border-radius:6px;text-align:center;cursor:pointer;font-size:14px;min-height:40px;display:flex;align-items:center;justify-content:center;word-break:break-word;}
  .cp-sp-btn:hover {background:#262629;}
  .cp-sp-btn.active {background:#1a73e8;font-weight:bold;}
  #cp-sp-notify-box {display:none;padding:10px;border-top:1px solid rgba(255,255,255,.05);}
  #cp-room-box{text-align:right;display:flex;justify-content:flex-end;align-items:center;}
  #cp-room-box div {padding:4px 22px;background:#5c3a1e;color:#fff;border-radius:5px;font-size:12px;display:flex;align-items:center;gap:4px;cursor:pointer;}
  #cp-room-box img {max-width:24px;border-radius:4px;}
  `;
                    document.head.appendChild(style);

                    const modal = document.createElement("div");
                    modal.id = "cp-showprofile-modal";
                    modal.innerHTML = `
    <div id="cp-sp-header">
      <span class="modal-title">
        <img id="cp-user-ico">
        <img id="cp-user-banner" class="fl u-ico" alt="">
        <span id="cp-user-name"></span>
      </span>
      <button class="cp-sp-close">Ã—</button>
    </div>
    <div id="cp-user-pic" class="fl u-pic fitimg"><div id="cp-user-pic-inner" class="bgf fl u-pic fitimg"></div></div>
    <div id="cp-user-msg"></div>
    <div id="cp-room-box"></div>
    <div id="cp-action-box">
      <div class="cp-sp-btn" id="cp-sp-private">Ù…Ø­Ø§Ø¯Ø«Ø© Ø®Ø§ØµØ©</div>
      <div class="cp-sp-btn" id="cp-sp-notify">ØªÙ†Ø¨ÙŠÙ‡</div>
      <div class="cp-sp-btn" id="cp-sp-like">â¤ï¸</div>
      <div class="cp-sp-btn" id="cp-sp-mic">Ø³Ø­Ø¨ Ø§Ù„Ù…Ø§ÙŠÙƒ</div>
      <div class="cp-sp-btn" id="cp-sp-mute">ÙƒØªÙ… Ø§Ù„Ù…Ø§ÙŠÙƒ</div>
      <div class="cp-sp-btn" id="cp-sp-allow">Ø³Ù…Ø§Ø­</div>
      <div class="cp-sp-btn" id="cp-sp-gift">Ø§Ø±Ø³Ù„ Ù‡Ø¯ÙŠØ©</div>
      <div class="cp-sp-btn" id="cp-sp-jokes">ÙƒØ´Ù Ø§Ù„Ù†ÙƒØ§Øª</div>
      <div class="cp-sp-btn" id="cp-sp-banner">Ø§Ù„Ø¨Ù†Ø±</div>
      <div class="cp-sp-btn" id="cp-sp-delpic">Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø©</div>
      <div class="cp-sp-btn" id="cp-sp-roomkick">Ø·Ø±Ø¯ Ù…Ù† Ø§Ù„ØºØ±ÙØ©</div>
      <div class="cp-sp-btn" id="cp-sp-promote">ØªØ±Ù‚ÙŠØ© Ø§Ù„Ù‰ Ù…Ø±Ø§Ù‚Ø¨</div>
      <div class="cp-sp-btn" id="cp-sp-kick">Ø·Ø±Ø¯</div>
      <div class="cp-sp-btn" id="cp-sp-ban">Ø¨Ø§Ù†Ø¯</div>
      <div class="cp-sp-btn" id="cp-sp-report">ØªØ¨Ù„ÙŠØº</div>
      <div class="cp-sp-btn" id="cp-sp-ignore">ØªØ¬Ø§Ù‡Ù„</div>
            <div class="cp-sp-btn" id="cp-sp-unignore">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¬Ø§Ù‡Ù„</div>
    </div>
    <div id="cp-sp-notify-box">
      <textarea id="cp-sp-notify-txt" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ù†Ø§..." 
        style="width:100%;height:70px;background:#0b0b0d;color:white;border-radius:6px;
        padding:8px;border:1px solid rgba(255,255,255,.1);"></textarea>
      <div style="display:flex;gap:8px;margin-top:8px;">
        <button class="cp-sp-small" id="cp-sp-send-not" 
          style="flex:1;padding:8px;border-radius:6px;background:#1a73e8;border:none;color:#fff;">
          Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
        </button>
        <button class="cp-sp-small secondary" id="cp-sp-cancel-not" 
          style="flex:1;padding:8px;border-radius:6px;background:#777;border:none;color:#fff;">
          Ø¥Ù„ØºØ§Ø¡
        </button>
      </div>
    </div>
  `;
                    document.body.appendChild(modal);

                    const close = modal.querySelector(".cp-sp-close"),
                        like = modal.querySelector("#cp-sp-like"),
                        notify = modal.querySelector("#cp-sp-notify"),
                        chat = modal.querySelector("#cp-sp-private"),
                        box = modal.querySelector("#cp-sp-notify-box"),
                        input = modal.querySelector("#cp-sp-notify-txt"),
                        send = modal.querySelector("#cp-sp-send-not"),
                        cancel = modal.querySelector("#cp-sp-cancel-not"),
                        userNameSpan = modal.querySelector("#cp-user-name"),
                        userPic = modal.querySelector("#cp-user-pic"),
                        roomMsg = modal.querySelector("#cp-user-msg"),
                        icoEl = modal.querySelector("#cp-user-ico"),
                        bannerEl = modal.querySelector("#cp-user-banner"),
                        roomBox = modal.querySelector("#cp-room-box");

                    // Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
                    const mic = modal.querySelector("#cp-sp-mic"),
                        mute = modal.querySelector("#cp-sp-mute"),
                        allow = modal.querySelector("#cp-sp-allow"),
                        gift = modal.querySelector("#cp-sp-gift"),
                        jokes = modal.querySelector("#cp-sp-jokes"),
                        banner = modal.querySelector("#cp-sp-banner"),
                        delpic = modal.querySelector("#cp-sp-delpic"),
                        roomkick = modal.querySelector("#cp-sp-roomkick"),
                        promote = modal.querySelector("#cp-sp-promote"),
                        kick = modal.querySelector("#cp-sp-kick"),
                        ban = modal.querySelector("#cp-sp-ban"),
                        report = modal.querySelector("#cp-sp-report"),
                        ignore = modal.querySelector("#cp-sp-ignore"),
                        unignore = modal.querySelector("#cp-sp-unignore");

                    close.onclick = () => hide();
                    cancel.onclick = () => {
                        input.value = "";
                        hideNotify();
                    };

                    let target = {
                        userId: null,
                        username: null
                    };

                    function show(id, name, bgImg) {
                        target.userId = id;
                        target.username = name || "";
                        const card = document.querySelector(".uid" + id);
                        const topic = card?.querySelector(".u-topic")?.textContent.trim() || name || id;
                        userNameSpan.textContent = topic;
                        const roomId = userRoomMap[id];
                        const roomName = roomNames[roomId] || "Ù„ÙŠØ³ ÙÙŠ ØºØ±ÙØ©";
                        if (roomId) {
                            const roomEl = document.querySelector(".room.r" + roomId);
                            const roomImg = roomEl?.querySelector(".u-pic")?.style.backgroundImage.replace(/^url\(["']?|["']?\)$/g, "").trim() || "";
                            roomBox.innerHTML = `
        <div onclick="rjoin('${roomId}')">
          ${roomImg ? `<img src="${roomImg}">` : ""}
          ${roomName}
        </div>`;
                        } else {
                            roomBox.innerHTML = `<div style="color:#aaa;font-size:13px;">Ù„ÙŠØ³ ÙÙŠ ØºØ±ÙØ©</div>`;
                        }
                        const ico = card?.querySelector(".u-ico")?.src || "";
                        if (ico) bannerEl.src = ico;
                        else bannerEl.removeAttribute("src");
                        const smallIco = card?.querySelector(".u-ico-small")?.src || "";
                        if (smallIco) icoEl.src = smallIco;
                        else icoEl.removeAttribute("src");
                        userPic.style.backgroundImage = bgImg ? `url(${bgImg})` : "none";
                        const innerPic = modal.querySelector("#cp-user-pic-inner");
                        if (innerPic) innerPic.style.backgroundImage = bgImg ? `url(${bgImg})` : "none";
                        const msg = card?.querySelector(".u-msg")?.textContent.trim() || "";
                        roomMsg.textContent = msg;
                        input.value = "";
                        hideNotify();
                        modal.style.display = "block";
                    }

                    function hide() {
                        modal.style.display = "none";
                        target = {
                            userId: null,
                            username: null
                        };
                    }

                    function showNotify() {
                        box.style.display = "block";
                    }

                    function hideNotify() {
                        box.style.display = "none";
                    }

                    // Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨
                    like.onclick = () => {
                        const id = target.userId;
                        if (!id) return;
                        sendSocketPayload("ccvimn", {
                                cmd: "like",
                                id
                            }) ?
                            (showToast("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨", 3000), like.classList.add("active"), setTimeout(() => like.classList.remove("active"), 1500)) :
                            showToast("âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨", 4000);
                    };

                    // Ø²Ø± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
                    notify.onclick = () => {
                        showNotify();
                    };
                    send.onclick = () => {
                        const msg = input.value.trim(),
                            id = target.userId;
                        if (!msg) return alert("Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø£ÙˆÙ„Ø§Ù‹");
                        sendSocketPayload("ccvimn", {
                                cmd: "not",
                                id,
                                msg
                            }) ?
                            (showToast("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡", 3000), input.value = "", hideNotify(), hide()) :
                            alert("âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
                    };

                    // Ø²Ø± Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø®Ø§ØµØ©
                    chat.onclick = () => {
                        const id = target.userId;
                        if (id) {
                            if (typeof openw === "function") {
                                openw(id, !0);
                                hide();
                            } else showToast("âŒ Ø¯Ø§Ù„Ø© openw ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©");
                        }
                    };

                    // Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©
                    mic.onclick = () => window._realSocket_.send(`42["msg",{"cmd":"wmn","data":"${target.userId}"}]`);
                    mute.onclick = () => window._realSocket_.send(`42["msg",{"cmd":"wmo","data":"${target.userId}"}]`);
                    allow.onclick = () => window._realSocket_.send(`42["msg",{"cmd":"wmc","data":"${target.userId}"}]`);
                    gift.onclick = () => sendSocketPayload("ccvimn", {
                        cmd: "gift",
                        id: target.userId,
                        gift: "z1JmoY8zNO.gif"
                    });
                    jokes.onclick = () => window._realSocket_.send(`42["msg",{"cmd":"wh","data":"${target.userId}"}]`);
                    banner.onclick = () => window._realSocket_.send(`42["msg",{"cmd":"\`np","data":{"u2":"${target.userId}","bnr":"z228g8gLcH.png"}}]`);
                    delpic.onclick = () => sendSocketPayload("ccvimn", {
                        cmd: "delpic",
                        id: target.userId
                    });
                    roomkick.onclick = () => sendSocketPayload("ccvimn", {
                        cmd: "roomkick",
                        id: target.userId
                    });
                    promote.onclick = () => showToast("ğŸš§ ØªØ±Ù‚ÙŠØ© Ø§Ù„Ù‰ Ù…Ø±Ø§Ù‚Ø¨ Ù„Ù… ØªÙØ¨Ø±Ù…Ø¬ Ø¨Ø¹Ø¯", 3000);
                    kick.onclick = () => sendSocketPayload("ccvimn", {
                        cmd: "kick",
                        id: target.userId
                    });
                    ban.onclick = () => sendSocketPayload("ccvimn", {
                        cmd: "ban",
                        id: target.userId
                    });
                    report.onclick = () => showToast("ğŸš§ Ø§Ù„ØªØ¨Ù„ÙŠØº Ù„Ù… ÙŠÙØ¨Ø±Ù…Ø¬ Ø¨Ø¹Ø¯", 3000);
                    ignore.onclick = () => showToast("ğŸš§ Ø§Ù„ØªØ¬Ø§Ù‡Ù„ Ù„Ù… ÙŠÙØ¨Ø±Ù…Ø¬ Ø¨Ø¹Ø¯", 3000);
                    unignore.onclick = () => showToast("ğŸš§ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¬Ø§Ù‡Ù„ Ù„Ù… ÙŠÙØ¨Ø±Ù…Ø¬ Ø¨Ø¹Ø¯", 3000);

                    window.cpShowProfile = {
                        show,
                        hide
                    };
                }

                document.querySelectorAll("div").forEach(bindProfileElement);
                new MutationObserver(mutations => {
                    mutations.forEach(m => {
                        m.addedNodes.forEach(el => {
                            if (el.nodeType === 1) {
                                bindProfileElement(el);
                                el.querySelectorAll && el.querySelectorAll("div").forEach(bindProfileElement);
                            }
                        });
                    });
                }).observe(document.body, {
                    childList: true,
                    subtree: true
                });
            })();

            // --- Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø«Ø§Ù„Ø«: Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¹Ù†Ø§ØµØ± + ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠÙŠÙ† ---
            (function() {
                function showUsers() {
                    document.querySelectorAll('.btn').forEach(el => el.style.display = 'block');
                    document.querySelectorAll('[class^="itarr"]').forEach(el => el.remove());

                    if (typeof _ma56zznz2 !== 'undefined' && Array.isArray(_ma56zznz2)) {
                        _ma56zznz2.forEach(obj => {
                            document.querySelectorAll(`.${obj.cls}`).forEach(el => {
                                el.classList.remove(obj.cls);
                                el.style.display = 'block';
                            });
                        });
                    }
                }

                // 2) Ø­Ø§ÙˆÙŠØ© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
                if (!document.getElementById("mobile-toast-container")) {
                    const container = document.createElement("div");
                    container.id = "mobile-toast-container";
                    container.style = "position:fixed;top:15px;left:50%;transform:translateX(-50%);z-index:99999;max-width:320px;text-align:center";
                    document.body.appendChild(container);
                }

                const alertedUsers = new Set();

                function showAlert(user) {
                    const toast = document.createElement("div");
                    toast.onclick = () => toast.remove();
                    toast.style = "background:#f0f0f0;border:2px solid #333;border-radius:10px;padding:10px;margin-top:10px;max-width:280px;font-family:sans-serif;color:#000;box-shadow:0 2px 6px rgba(0,0,0,.2);cursor:pointer;text-align:left";
                    toast.innerHTML = `
      <div style="font-weight:bold;text-align:center;margin-bottom:8px">ğŸ”” ØªÙ†Ø¨ÙŠÙ‡</div>
      <div style="display:flex;align-items:center;gap:8px">
        <img src="${user.pic}" style="width:32px;height:32px;border-radius:50%;border:1px solid #ccc">
        ${user.icon ? `<img src="${user.icon}" style="height:20px">` : ""}
        <div style="flex-grow:1">
          <div style="font-weight:bold">${user.name}</div>
          <div style="font-size:12px;color:gray">${user.hash}</div>
        </div>
      </div>
      <div style="margin-top:10px;padding:8px;background:#e0e0e0;border-radius:6px;text-align:center;font-weight:bold">Ø¯Ø®Ù„ Ù…Ø®ÙÙŠ Ù„Ù„Ø±ÙˆÙ…</div>
    `;
                    document.getElementById("mobile-toast-container").appendChild(toast);
                }

                // 3) Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø®ÙÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                function showAllHigherRanksOnlyHidden() {
                    const hiddenSelector = [
                        ".uzr[style*='max-height: 0']",
                        ".uzr[style*='max-height:0']"
                    ].join(",");

                    document.querySelectorAll(hiddenSelector).forEach(el => {
                        el.setAttribute('data-was-hidden', '1');
                    });

                    document.querySelectorAll("[data-was-hidden='1']").forEach(el => {
                        const searchBox = document.getElementById('usearch');
                        if (searchBox && searchBox.value.trim().length > 0) return;

                        el.style.display = '';
                        el.style.maxHeight = '';
                        el.querySelectorAll('[style*="display: none"]').forEach(inner => {
                            inner.style.display = '';
                        });

                        const ustat = el.querySelector("img.ustat, img[src*='s0.png'], img[src*='s4.png']");
                        if (ustat) ustat.src = 'imgs/s4.png';

                        const nameAttr = el.getAttribute('n');
                        const nameSpan = el.querySelector('.u-topic');
                        if (nameSpan && nameSpan.textContent.trim() === '') {
                            if (nameAttr && nameAttr.trim() !== '') {
                                nameSpan.textContent = nameAttr;
                            } else {
                                const orig = nameSpan.getAttribute('data-original');
                                if (orig) nameSpan.textContent = orig;
                            }
                        }

                        const pic = el.querySelector('.u-pic');
                        if (pic) {
                            const origPic = pic.getAttribute('data-original-pic');
                            if (origPic) {
                                pic.style.backgroundImage = `url("${origPic}")`;
                            } else {
                                const fallback = el.getAttribute('data-pic');
                                if (fallback) pic.style.backgroundImage = `url("${fallback}")`;
                            }
                        }
                    });
                }

                // 4) Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† Ø¨Ø´ÙƒÙ„ Ø´Ø§Ù…Ù„
                function fixHiddenFrames() {
                    document.querySelectorAll('.uzr').forEach(el => {
                        const style = window.getComputedStyle(el);
                        if (style.width === '0px' || style.height === '0px') {
                            el.style.width = '';
                            el.style.height = '';
                        }

                        const frameImg = el.querySelector('.u-pic img[class^="itarr_"]');
                        if (frameImg) {
                            frameImg.classList.forEach(cls => {
                                if (cls.startsWith('itarr_')) {
                                    const frameName = cls.replace('itarr_', '').toLowerCase();
                                    if (el.classList.contains(frameName)) {
                                        el.classList.remove(frameName);
                                    }
                                }
                            });
                        }

                        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø§ØµØ© Ù„ÙƒÙ„Ø§Ø³ ahmed
                        if (el.classList.contains('ahmed')) {
                            el.classList.remove('ahmed');
                            el.style.width = '';
                            el.style.height = '';
                        }

                        // â­ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø§ØµØ© Ù„ÙƒÙ„Ø§Ø³ mhmood (Ù…Ø­Ù…Ø¯)
                        if (el.classList.contains('mhmood')) {
                            el.classList.remove('mhmood');
                            el.style.width = '';
                            el.style.height = '';
                        }

                        const topic = el.querySelector('.u-topic');
                        if (topic) {
                            const bg = window.getComputedStyle(topic).backgroundColor;
                            const color = window.getComputedStyle(topic).color;
                            if (bg === color) {
                                topic.style.color = '#000';
                            }
                        }
                    });
                }

                // 5) ÙØ­Øµ Ø§Ù„Ù…Ø®ÙÙŠÙŠÙ† ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡
                function checkHiddenUsers() {
                    document.querySelectorAll('.uzr.inroom').forEach(userEl => {
                        const statusImg = userEl.querySelector('img.ustat');
                        if (statusImg && statusImg.src.includes('s4.png')) {
                            const uidClass = [...userEl.classList].find(c => c.startsWith('uid'));
                            if (uidClass && !alertedUsers.has(uidClass)) {
                                alertedUsers.add(uidClass);
                                const name = userEl.getAttribute("n")?.trim() || "Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…";

                                let pic = "pic/unknown.png";
                                const picDiv = userEl.querySelector('.u-pic');
                                if (picDiv) {
                                    const bg = picDiv.style.backgroundImage || window.getComputedStyle(picDiv).backgroundImage;
                                    const match = bg.match(/url\(["']?(.*?)["']?\)/);
                                    if (match && match[1]) {
                                        pic = match[1].startsWith('http') ? match[1] : window.location.origin + '/' + match[1].replace(/^\/+/, '');
                                    }
                                }

                                const icon = userEl.querySelector('.u-ico')?.src || "";
                                const hash = userEl.querySelector('.uhash')?.textContent || "";
                                showAlert({
                                    name,
                                    pic,
                                    icon,
                                    hash
                                });
                            }
                        }
                    });

                    for (const uid of alertedUsers) {
                        if (!document.querySelector(`.uzr.inroom.${uid} img.ustat[src*="s4.png"]`)) {
                            alertedUsers.delete(uid);
                        }
                    }
                }

                // 6) Ù…Ø±Ø§Ù‚Ø¨Ø© DOM
                new MutationObserver(() => {
                    const searchBox = document.getElementById('usearch');
                    if (searchBox && searchBox.value.trim().length > 0) return;

                    showUsers();
                    showAllHigherRanksOnlyHidden();
                    fixHiddenFrames();
                    checkHiddenUsers();
                }).observe(document.body, {
                    childList: true,
                    subtree: true
                });

                showUsers();
                showAllHigherRanksOnlyHidden();
                fixHiddenFrames();
                checkHiddenUsers();

                console.log("âœ… ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„: Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ø²Ø±Ø§Ø± + Ø§Ù„Ù…Ø®ÙÙŠÙŠÙ† + Ø¥ØµÙ„Ø§Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† (Ø¨Ù…Ø§ ÙÙŠÙ‡Ø§ ahmed + mhmood) + ØªÙ†Ø¨ÙŠÙ‡ Ù…Ø¹ Ø§Ø®ØªÙØ§Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ.");
            })();

            console.log("ğŸš€ ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø«Ø§Ù†ÙŠ ÙˆØ§Ù„Ø«Ø§Ù„Ø« Ø¨Ø¹Ø¯ Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø§ØªØµØ§Ù„");
        }
    }, 500);


})();
